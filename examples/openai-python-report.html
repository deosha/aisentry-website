<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aisentry Report</title>
    <style>
        
        /* CSS Variables for theming */
        :root, [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --accent-primary: #f97316;
            --accent-secondary: #ea580c;
            --accent-gradient: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border-color: #334155;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.4);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .container { max-width: 1280px; margin: 0 auto; padding: 24px; }

        /* Header */
        header {
            background: var(--accent-gradient);
            color: white;
            padding: 24px 32px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(249, 115, 22, 0.3);
        }
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .logo {
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 12px;
        }
        header h1 { font-size: 1.5em; font-weight: 700; margin-bottom: 2px; }
        .generated { opacity: 0.9; font-size: 0.85em; }

        /* Theme Toggle */
        .theme-toggle {
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            transition: all 0.3s;
        }
        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        [data-theme="light"] .moon-icon { display: none; }
        [data-theme="dark"] .sun-icon { display: none; }

        /* Cards */
        .summary-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--card-shadow);
            transition: box-shadow 0.3s, transform 0.3s;
        }
        .summary-card:hover {
            box-shadow: var(--card-shadow-hover);
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .metric {
            text-align: center;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 12px;
            transition: transform 0.3s;
        }
        .metric:hover { transform: translateY(-2px); }
        .metric-value {
            font-size: 2.5em;
            font-weight: 800;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .metric-label { color: var(--text-secondary); font-size: 0.9em; margin-top: 4px; }

        /* Circular Score Gauge */
        .score-gauge {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 12px;
        }
        .score-gauge svg {
            transform: rotate(-90deg);
        }
        .score-gauge-bg {
            fill: none;
            stroke: var(--bg-tertiary);
            stroke-width: 8;
        }
        .score-gauge-fill {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease-out;
        }
        .score-gauge-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.8em;
            font-weight: 800;
        }
        .score-high .score-gauge-fill { stroke: var(--success); }
        .score-medium .score-gauge-fill { stroke: var(--warning); }
        .score-low .score-gauge-fill { stroke: var(--danger); }
        .score-high .score-gauge-text { color: var(--success); }
        .score-medium .score-gauge-text { color: var(--warning); }
        .score-low .score-gauge-text { color: var(--danger); }

        .section { margin-bottom: 32px; }
        .section h2 {
            color: var(--text-primary);
            font-size: 1.3em;
            font-weight: 700;
            padding-bottom: 12px;
            margin-bottom: 16px;
            border-bottom: 3px solid var(--accent-primary);
            display: inline-block;
        }
        .section h3 {
            color: var(--text-primary);
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 16px;
        }

        /* Findings & Vulnerabilities */
        .finding, .vulnerability {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: var(--card-shadow);
            border-left: 4px solid;
            transition: all 0.3s;
        }
        .finding:hover, .vulnerability:hover {
            box-shadow: var(--card-shadow-hover);
            transform: translateX(4px);
        }
        .severity-critical { border-left-color: #ef4444; }
        .severity-high { border-left-color: #f97316; }
        .severity-medium { border-left-color: #f59e0b; }
        .severity-low { border-left-color: #3b82f6; }
        .severity-info { border-left-color: #64748b; }

        .finding-header, .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        .finding-title, .vuln-title {
            font-weight: 600;
            font-size: 1.05em;
            color: var(--text-primary);
        }

        /* Badges with icons */
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .badge::before { font-size: 0.9em; }
        .badge-critical { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .badge-critical::before { content: "üî¥"; }
        .badge-high { background: linear-gradient(135deg, #f97316, #ea580c); }
        .badge-high::before { content: "üü†"; }
        .badge-medium { background: linear-gradient(135deg, #f59e0b, #d97706); color: #1e293b; }
        .badge-medium::before { content: "üü°"; }
        .badge-low { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .badge-low::before { content: "üîµ"; }
        .badge-info { background: linear-gradient(135deg, #64748b, #475569); }
        .badge-info::before { content: "‚ö™"; }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'Fira Code', 'Monaco', monospace;
            font-size: 0.85em;
            margin: 12px 0;
            border: 1px solid var(--border-color);
        }
        .location {
            color: var(--text-muted);
            font-size: 0.85em;
            margin-bottom: 8px;
            font-family: monospace;
        }
        .description {
            margin: 12px 0;
            color: var(--text-secondary);
            line-height: 1.7;
        }
        .remediation {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(234, 88, 12, 0.05));
            border: 1px solid rgba(249, 115, 22, 0.2);
            padding: 16px;
            border-radius: 10px;
            margin-top: 12px;
        }
        [data-theme="dark"] .remediation {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(234, 88, 12, 0.1));
        }
        .remediation-title {
            font-weight: 600;
            color: var(--accent-primary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .remediation-title::before { content: "üí°"; }

        .detector-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--card-shadow);
            transition: all 0.3s;
        }
        .detector-card:hover {
            box-shadow: var(--card-shadow-hover);
            transform: translateY(-2px);
        }
        .detector-info h3 { font-size: 1em; margin-bottom: 4px; color: var(--text-primary); }
        .detector-stats { display: flex; gap: 24px; }
        .stat { text-align: center; }
        .stat-value { font-weight: 700; font-size: 1.3em; color: var(--accent-primary); }
        .stat-label { font-size: 0.75em; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

        /* Animated Progress Bar */
        .progress-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 4px;
            animation: progressFill 1s ease-out forwards;
            transform-origin: left;
        }
        @keyframes progressFill {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }

        footer {
            text-align: center;
            padding: 24px;
            color: var(--text-muted);
            font-size: 0.9em;
            border-top: 1px solid var(--border-color);
            margin-top: 32px;
        }
        footer a {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: 500;
        }
        footer a:hover { text-decoration: underline; }

        .severity-breakdown {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        .severity-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .severity-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        /* Filter Toolbar - Modern Sticky Design */
        .filter-toolbar {
            position: sticky;
            top: 0;
            z-index: 100;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .filter-toolbar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .filter-toolbar-title {
            color: white;
            font-size: 0.9em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .filter-toolbar-title svg {
            width: 18px;
            height: 18px;
        }
        .filter-stats-badge {
            background: rgba(255,255,255,0.15);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
        }
        .filter-stats-badge strong {
            color: #60a5fa;
        }
        .filter-sections {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-start;
        }
        .filter-section {
            flex: 1;
            min-width: 180px;
        }
        .filter-section-label {
            color: rgba(255,255,255,0.7);
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .filter-section-actions {
            font-size: 0.9em;
        }
        .filter-section-actions a {
            color: #60a5fa;
            text-decoration: none;
            margin-left: 8px;
        }
        .filter-section-actions a:hover {
            text-decoration: underline;
        }
        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        .filter-chip {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            user-select: none;
        }
        .filter-chip.severity-chip {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.6);
        }
        .filter-chip.severity-chip.active[data-value="CRITICAL"] {
            background: #dc3545;
            color: white;
        }
        .filter-chip.severity-chip.active[data-value="HIGH"] {
            background: #fd7e14;
            color: white;
        }
        .filter-chip.severity-chip.active[data-value="MEDIUM"] {
            background: #ffc107;
            color: #333;
        }
        .filter-chip.severity-chip.active[data-value="LOW"] {
            background: #17a2b8;
            color: white;
        }
        .filter-chip.severity-chip.active[data-value="INFO"] {
            background: #6c757d;
            color: white;
        }
        .filter-chip.category-chip {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.6);
        }
        .filter-chip.category-chip.active {
            background: #667eea;
            color: white;
        }
        .filter-chip:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .filter-chip .chip-count {
            font-size: 0.85em;
            opacity: 0.8;
        }
        .filter-search-box {
            flex: 1;
            min-width: 200px;
        }
        .filter-search-input {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            color: white;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        .filter-search-input::placeholder {
            color: rgba(255,255,255,0.4);
        }
        .filter-search-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255,255,255,0.1);
        }
        .filter-reset-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .filter-reset-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        /* Hidden class for filtered items */
        .finding.filtered-out,
        .vulnerability.filtered-out {
            display: none !important;
        }

        /* No results message */
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .no-results-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        .no-results h3 {
            color: #333;
            margin-bottom: 8px;
        }

        /* Tab Navigation - Pill Style */
        .tab-navigation {
            display: flex;
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 6px;
            box-shadow: var(--card-shadow);
            margin-bottom: 0;
            gap: 6px;
        }
        .tab-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            background: transparent;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .tab-btn::before {
            font-size: 1.1em;
        }
        .tab-btn[data-tab="vulnerabilities"]::before { content: "üõ°Ô∏è"; }
        .tab-btn[data-tab="security-posture"]::before { content: "üìä"; }
        .tab-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        .tab-btn.active {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
        }
        .tab-btn .tab-badge {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }
        .tab-btn.active .tab-badge {
            background: rgba(255,255,255,0.25);
            color: white;
        }
        .tab-content {
            display: none;
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--card-shadow);
            margin-top: 12px;
            margin-bottom: 24px;
            animation: fadeIn 0.3s ease;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Audit-specific styles */
        .audit-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        .audit-metric {
            text-align: center;
            padding: 24px 20px;
            background: var(--bg-tertiary);
            border-radius: 16px;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        .audit-metric:hover {
            transform: translateY(-4px);
            box-shadow: var(--card-shadow);
        }
        .audit-metric-value {
            font-size: 2.5em;
            font-weight: 800;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .audit-metric-label {
            color: var(--text-secondary);
            font-size: 0.85em;
            margin-top: 6px;
            font-weight: 500;
        }
        .maturity-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 10px;
        }
        .maturity-badge::before { font-size: 0.9em; }
        .maturity-initial { background: linear-gradient(135deg, #fee2e2, #fecaca); color: #dc2626; }
        .maturity-initial::before { content: "‚ö†Ô∏è"; }
        .maturity-developing { background: linear-gradient(135deg, #ffedd5, #fed7aa); color: #ea580c; }
        .maturity-developing::before { content: "üîÑ"; }
        .maturity-defined { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706; }
        .maturity-defined::before { content: "üìã"; }
        .maturity-managed { background: linear-gradient(135deg, #d1fae5, #a7f3d0); color: #059669; }
        .maturity-managed::before { content: "‚úÖ"; }
        .maturity-optimizing { background: linear-gradient(135deg, #cffafe, #a5f3fc); color: #0891b2; }
        .maturity-optimizing::before { content: "üöÄ"; }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .category-card {
            background: var(--bg-tertiary);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            overflow: hidden;
        }
        .category-card:hover {
            box-shadow: var(--card-shadow);
        }
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
        }
        .category-header:hover {
            background: var(--bg-secondary);
        }
        .category-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .category-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.05em;
        }
        .category-score {
            font-weight: 800;
            color: var(--accent-primary);
            font-size: 1.2em;
        }
        .accordion-icon {
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease;
            color: var(--text-muted);
        }
        .category-card.open .accordion-icon {
            transform: rotate(180deg);
        }
        .category-progress {
            height: 4px;
            background: var(--border-color);
            overflow: hidden;
        }
        .category-progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            animation: progressFill 1s ease-out forwards;
            transform-origin: left;
        }
        .category-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .category-card.open .category-content {
            max-height: 2000px;
            transition: max-height 0.5s ease-in;
        }
        .control-list {
            list-style: none;
            padding: 0 20px 20px;
        }
        .control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }
        .control-item:last-child {
            border-bottom: none;
        }
        .control-name {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        .control-status {
            font-size: 0.75em;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .control-status::before { font-size: 0.85em; }
        .status-detected { background: linear-gradient(135deg, #d1fae5, #a7f3d0); color: #059669; }
        .status-detected::before { content: "‚úì"; }
        .status-missing { background: linear-gradient(135deg, #fee2e2, #fecaca); color: #dc2626; }
        .status-missing::before { content: "‚úó"; }
        .status-partial { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706; }
        .status-partial::before { content: "~"; }
        .category-stats {
            display: flex;
            gap: 16px;
            padding: 12px 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .stat-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        .stat-dot.detected { background: #059669; }
        .stat-dot.partial { background: #d97706; }
        .stat-dot.missing { background: #dc2626; }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 16px;
        }
        .section-header h3 {
            margin: 0;
            color: var(--text-primary);
            border-bottom: 2px solid var(--accent-primary);
            padding-bottom: 8px;
        }
        .expand-toggle {
            font-size: 0.8rem;
            color: var(--accent-primary);
            cursor: pointer;
            padding: 4px 12px;
            border: 1px solid var(--accent-primary);
            border-radius: 6px;
            background: var(--bg-secondary);
            transition: all 0.2s;
        }
        .expand-toggle:hover {
            background: var(--accent-primary);
            color: white;
        }

        .recommendations-section {
            margin-top: 32px;
        }
        .recommendations-section h3 {
            color: var(--text-primary);
            font-size: 1.15em;
            font-weight: 700;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--accent-primary);
            display: inline-block;
        }
        .rec-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .rec-item {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 18px;
            border-left: 4px solid;
            transition: all 0.3s;
        }
        .rec-item:hover {
            transform: translateX(4px);
            box-shadow: var(--card-shadow);
        }
        .rec-critical { border-color: #ef4444; }
        .rec-high { border-color: #f97316; }
        .rec-medium { border-color: #f59e0b; }
        .rec-low { border-color: #3b82f6; }
        .rec-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .rec-title {
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }
        .rec-priority {
            font-size: 0.7em;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .priority-critical { background: linear-gradient(135deg, #fee2e2, #fecaca); color: #dc2626; }
        .priority-high { background: linear-gradient(135deg, #ffedd5, #fed7aa); color: #ea580c; }
        .priority-medium { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706; }
        .priority-low { background: linear-gradient(135deg, #dbeafe, #bfdbfe); color: #2563eb; }
        .rec-description {
            color: var(--text-secondary);
            font-size: 0.9em;
            line-height: 1.6;
        }

        /* Combined score display */
        .combined-score-section {
            background: var(--accent-gradient);
            border-radius: 20px;
            padding: 28px;
            margin-bottom: 24px;
            color: white;
            box-shadow: 0 10px 40px rgba(249, 115, 22, 0.3);
        }
        .combined-score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            text-align: center;
        }
        .combined-metric {
            padding: 20px;
            background: rgba(255,255,255,0.15);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        .combined-metric:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-4px);
        }
        .combined-metric-value {
            font-size: 2.8em;
            font-weight: 800;
        }
        .combined-metric-label {
            font-size: 0.85em;
            opacity: 0.95;
            margin-top: 6px;
            font-weight: 500;
        }

        /* Severity Filter Buttons */
        .severity-filter-btn {
            padding: 10px 18px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .severity-filter-btn::before {
            font-size: 0.9em;
        }
        .severity-filter-btn[data-severity="all"]::before { content: "üìã"; }
        .severity-filter-btn[data-severity="critical"]::before { content: "üî¥"; }
        .severity-filter-btn[data-severity="high"]::before { content: "üü†"; }
        .severity-filter-btn[data-severity="medium"]::before { content: "üü°"; }
        .severity-filter-btn[data-severity="low"]::before { content: "üîµ"; }
        .severity-filter-btn[data-severity="info"]::before { content: "‚ö™"; }
        .severity-filter-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
            transform: translateY(-2px);
        }
        .severity-filter-btn.active {
            background: var(--accent-gradient);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
        }
        .severity-filter-btn[data-severity="critical"].active {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        .severity-filter-btn[data-severity="high"].active {
            background: linear-gradient(135deg, #f97316, #ea580c);
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
        }
        .severity-filter-btn[data-severity="medium"].active {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: #1e293b;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        .severity-filter-btn[data-severity="low"].active {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        .severity-filter-btn[data-severity="info"].active {
            background: linear-gradient(135deg, #64748b, #475569);
            box-shadow: 0 4px 12px rgba(100, 116, 139, 0.3);
        }
        .filter-count {
            opacity: 0.85;
            font-weight: 500;
        }

        /* Hidden items for pagination */
        .rec-hidden, .finding-hidden {
            display: none !important;
        }
        .rec-filtered, .finding-filtered {
            display: none !important;
        }

        /* Load More Button */
        .load-more-btn {
            padding: 14px 36px;
            background: var(--accent-gradient);
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(249, 115, 22, 0.35);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .load-more-btn::before {
            content: "‚Üì";
            font-size: 1.1em;
        }
        .load-more-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(249, 115, 22, 0.45);
        }
        .load-more-btn:active {
            transform: translateY(-1px);
        }
        .load-more-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        #remaining-count, #findings-remaining-count {
            opacity: 0.9;
            font-weight: 500;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                            <path d="M9 12l2 2 4-4"/>
                        </svg>
                    </div>
                    <div>
                        <h1>aisentry Report</h1>
                        <p class="generated">Generated: 2026-01-12 12:40:27 UTC</p>
                    </div>
                </div>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">
                    <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                    </svg>
                    <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
            </div>
        </header>
        
        <div class="combined-score-section">
            <div class="combined-score-grid">
                <div class="combined-metric">
                    <div class="combined-metric-value">10</div>
                    <div class="combined-metric-label">Combined Security Score</div>
                </div>
                <div class="combined-metric">
                    <div class="combined-metric-value">2</div>
                    <div class="combined-metric-label">Vulnerability Score</div>
                </div>
        
                <div class="combined-metric">
                    <div class="combined-metric-value">18</div>
                    <div class="combined-metric-label">Security Posture</div>
                </div>
            
            </div>
        </div>
        
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="vulnerabilities">
                Vulnerabilities
                <span class="tab-badge">9</span>
            </button>
        
            <button class="tab-btn" data-tab="security-posture">
                Security Posture
                <span class="tab-badge">18/61</span>
            </button>
            </div>
        <div id="vulnerabilities" class="tab-content active">
            
        <div class="audit-summary">
            <div class="audit-metric">
                <div class="audit-metric-value">1034</div>
                <div class="audit-metric-label">Files Scanned</div>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">9</div>
                <div class="audit-metric-label">Issues Found</div>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">64%</div>
                <div class="audit-metric-label">Confidence</div>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">4.2s</div>
                <div class="audit-metric-label">Scan Time</div>
            </div>
        </div>
        
            <div class="section">
                <h3>Vulnerabilities (9)</h3>

                <!-- Severity Filter -->
                <div class="severity-filter" style="margin-bottom: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="severity-filter-btn active" data-severity="all" data-target="findings" onclick="filterFindingsBySeverity('all')">
                        All <span class="filter-count">(9)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="critical" data-target="findings" onclick="filterFindingsBySeverity('critical')">
                        Critical <span class="filter-count">(1)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="high" data-target="findings" onclick="filterFindingsBySeverity('high')">
                        High <span class="filter-count">(7)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="medium" data-target="findings" onclick="filterFindingsBySeverity('medium')">
                        Medium <span class="filter-count">(0)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="low" data-target="findings" onclick="filterFindingsBySeverity('low')">
                        Low <span class="filter-count">(0)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="info" data-target="findings" onclick="filterFindingsBySeverity('info')">
                        Info <span class="filter-count">(1)</span>
                    </button>
                </div>

                <div class="findings-list" id="findings-list">
            
                <div class="finding severity-info " data-severity="info" data-category="LLM09: Overreliance" data-index="0">
                    <div class="finding-header">
                        <span class="finding-title">Critical decision without oversight in &#x27;sync_main&#x27;</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM09: Overreliance</span>
                            <span class="badge badge-info">INFO</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/examples/azure_ad.py:17</div>
                    <div class="description">Function &#x27;sync_main&#x27; on line 17 makes critical security decisions based on LLM output without human oversight or verification. No action edges detected - advisory only.</div>
                    <div class="code-block"><code>

def sync_main() -&gt; None:
    from azure.identity import DefaultAzureCredential, get_bearer_token_provider

    token_provider: AzureADTokenProvider = get_bearer_token_provider(DefaultAzureCredential(), scopes)</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Critical security decision requires human oversight:

1. Implement human-in-the-loop review:
   - Add review queue for high-stakes decisions
   - Require explicit human approval before execution
   - Log all decisions for audit trail

2. Add verification mechanisms:
   - Cross-reference with trusted sources
   - Implement multi-step verification
   - Use confidence thresholds

3. Include safety checks:
   - Set limits on transaction amounts
   - Require secondary confirmation
   - Implement rollback mechanisms

4. Add disclaimers:
   - Inform users output may be incorrect
   - Recommend professional consultation
   - Document limitations clearly

5. Monitor and review:
   - Track decision outcomes
   - Review failures and near-misses
   - Continuously improve safeguards
                    </div>
                </div>
                
                <div class="finding severity-critical " data-severity="critical" data-category="LLM02: Insecure Output Handling" data-index="1">
                    <div class="finding-header">
                        <span class="finding-title">LLM output flows to command_injection sink</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM02: Insecure Output Handling</span>
                            <span class="badge badge-critical">CRITICAL</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:792</div>
                    <div class="description">LLM output variable &#x27;run&#x27; flows to &#x27;self.runs.poll&#x27; on line 792 via direct flow. This creates a command_injection vulnerability.</div>
                    <div class="code-block"><code>        )
        return self.runs.poll(run.id, run.thread_id, extra_headers, extra_query, extra_body, timeout, poll_interval_ms)  # pyright: ignore[reportDeprecated]

    @overload</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Mitigations for Command Injection:
1. Never pass LLM output to shell commands
2. Use subprocess with shell=False and list arguments
3. Apply allowlist validation for expected values
4. Use shlex.quote() if shell execution is unavoidable
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="2">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_poll&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:739</div>
                    <div class="description">Tool function &#x27;create_and_run_poll&#x27; on line 739 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>            stream=stream or False,
            stream_cls=Stream[AssistantStreamEvent],
        )

    def create_and_run_poll(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="3">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:795</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 795 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>        )
        return self.runs.poll(run.id, run.thread_id, extra_headers, extra_query, extra_body, timeout, poll_interval_ms)  # pyright: ignore[reportDeprecated]

    @overload
    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="4">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:824</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 824 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>        &quot;&quot;&quot;Create a thread and stream the run back&quot;&quot;&quot;
        ...

    @overload
    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="5">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:853</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 853 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>    ) -&gt; AssistantStreamManager[AssistantEventHandlerT]:
        &quot;&quot;&quot;Create a thread and stream the run back&quot;&quot;&quot;
        ...

    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="6">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1655</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 1655 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>            run.id, run.thread_id, extra_headers, extra_query, extra_body, timeout, poll_interval_ms
        )

    @overload
    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="7">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1684</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 1684 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>        &quot;&quot;&quot;Create a thread and stream the run back&quot;&quot;&quot;
        ...

    @overload
    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                <div class="finding severity-high " data-severity="high" data-category="LLM07: Insecure Plugin Design" data-index="8">
                    <div class="finding-header">
                        <span class="finding-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations</span>
                        <div>
                            <span class="badge" style="background: #6c757d; margin-right: 5px;">LLM07: Insecure Plugin Design</span>
                            <span class="badge badge-high">HIGH</span>
                        </div>
                    </div>
                    <div class="location">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1713</div>
                    <div class="description">Tool function &#x27;create_and_run_stream&#x27; on line 1713 takes LLM output as a parameter and performs dangerous operations (http_request) without proper validation. Attackers can craft malicious LLM outputs to execute arbitrary commands, access files, or perform SQL injection.</div>
                    <div class="code-block"><code>    ) -&gt; AsyncAssistantStreamManager[AsyncAssistantEventHandlerT]:
        &quot;&quot;&quot;Create a thread and stream the run back&quot;&quot;&quot;
        ...

    def create_and_run_stream(
        self,
        *,
        assistant_id: str,
        instructions: Optional[str] | Omit = omit,
        max_completion_tokens: Optional[int] | Omit = omit,</code></div>
                    <div class="remediation">
                        <div class="remediation-title">Remediation</div>
                        Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations
                    </div>
                </div>
                
                </div>

                <!-- Load More Button -->
                <div id="findings-load-more-container" style="text-align: center; margin-top: 16px;">
                    <button id="findings-load-more-btn" class="load-more-btn" onclick="loadMoreFindings()">
                        Show More <span id="findings-remaining-count"></span>
                    </button>
                </div>
            </div>
            
        </div>
        
            <div id="security-posture" class="tab-content">
                
        <div class="audit-summary">
            <div class="audit-metric">
                <div class="audit-metric-value">18</div>
                <div class="audit-metric-label">Overall Score</div>
                <span class="maturity-badge maturity-initial">Initial</span>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">18</div>
                <div class="audit-metric-label">Controls Detected</div>
                <span class="maturity-badge" style="background: #f1f5f9; color: #64748b;">of 61</span>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">1155</div>
                <div class="audit-metric-label">Files Analyzed</div>
            </div>
            <div class="audit-metric">
                <div class="audit-metric-value">92</div>
                <div class="audit-metric-label">Total Recommendations</div>
            </div>
        </div>

        <div class="section-header">
            <h3 style="color: var(--text-primary); border-bottom: 2px solid var(--accent-primary); padding-bottom: 8px;">Category Scores</h3>
            <button class="expand-toggle" id="toggle-categories" onclick="toggleAllCategories()">Expand All</button>
        </div>
        <div class="category-grid">
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Prompt Security</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">22/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 21.875%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Prompt Sanitization</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Rate Limiting</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Input Validation</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Output Filtering</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Context Window Protection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Red Team Testing</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Prompt Anomaly Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">System Prompt Protection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 3 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 5 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Model Security</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">9/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 9.375%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Access Control</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Versioning</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Dependency Scanning</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">API Security</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Source Verification</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Differential Privacy</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Watermarking</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Secure Model Loading</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 1 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 7 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Data Privacy</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">12/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 12.5%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">PII Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Data Redaction</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Data Encryption</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Audit Logging</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Consent Management</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">NER PII Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Data Retention Policy</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">GDPR Compliance</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 2 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 6 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">OWASP LLM Top 10</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">25/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 25.0%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">LLM01: Prompt Injection Defense</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM02: Insecure Output Handling</span>
                <span class="control-status status-partial">Partial</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM03: Training Data Poisoning</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM04: Model Denial of Service</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM05: Supply Chain Vulnerabilities</span>
                <span class="control-status status-partial">Partial</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM06: Sensitive Information Disclosure</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM07: Insecure Plugin Design</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM08: Excessive Agency</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM09: Overreliance</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">LLM10: Model Theft</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 3 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 2 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 5 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Blue Team Operations</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">18/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 17.857142857142858%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Model Monitoring</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Drift Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Anomaly Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Adversarial Attack Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">AI Incident Response</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Drift Monitoring</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Data Quality Monitoring</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 2 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 5 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">AI Governance</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">0/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 0.0%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Model Explainability</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Bias Detection</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Documentation</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Compliance Tracking</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Human Oversight</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 0 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 5 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Supply Chain Security</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">25/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 25.0%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Dependency Scanning</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Provenance Tracking</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Integrity Verification</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 1 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 2 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Hallucination Mitigation</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">35/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 35.0%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">RAG Implementation</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Confidence Scoring</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Source Attribution</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Temperature Control</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Fact Checking</span>
                <span class="control-status status-detected">Advanced</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 3 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 2 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Ethical AI &amp; Bias</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">12/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 12.5%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Fairness Metrics</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Explainability</span>
                <span class="control-status status-detected">Intermediate</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Bias Testing</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Model Cards</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 1 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 3 Missing</span>
                </div>
            </div>
        </div>
        
        <div class="category-card">
            <div class="category-header" onclick="toggleCategory(this)">
                <div class="category-header-left">
                    <span class="category-name">Incident Response</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span class="category-score">0/100</span>
                    <svg class="accordion-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
                </div>
            </div>
            <div class="category-progress">
                <div class="category-progress-fill" style="width: 0.0%"></div>
            </div>
            <div class="category-content">
                <ul class="control-list">
                    
            <li class="control-item">
                <span class="control-name">Monitoring Integration</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Audit Logging</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
            <li class="control-item">
                <span class="control-name">Rollback Capability</span>
                <span class="control-status status-missing">Missing</span>
            </li>
            
                </ul>
                <div class="category-stats">
                    <span class="stat-item"><span class="stat-dot detected"></span> 0 Detected</span>
                    <span class="stat-item"><span class="stat-dot partial"></span> 0 Partial</span>
                    <span class="stat-item"><span class="stat-dot missing"></span> 3 Missing</span>
                </div>
            </div>
        </div>
        </div>
            <div class="recommendations-section">
                <h3>All Recommendations (92)</h3>

                <!-- Severity Filter -->
                <div class="severity-filter" style="margin-bottom: 16px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button class="severity-filter-btn active" data-severity="all" onclick="filterBySeverity('all')">
                        All <span class="filter-count">(92)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="critical" onclick="filterBySeverity('critical')">
                        Critical <span class="filter-count">(84)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="high" onclick="filterBySeverity('high')">
                        High <span class="filter-count">(7)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="medium" onclick="filterBySeverity('medium')">
                        Medium <span class="filter-count">(0)</span>
                    </button>
                    <button class="severity-filter-btn" data-severity="low" onclick="filterBySeverity('low')">
                        Low <span class="filter-count">(1)</span>
                    </button>
                </div>

                <div class="rec-list" id="recommendations-list">
            
                <div class="rec-item rec-critical " data-priority="critical" data-index="0">
                    <div class="rec-header">
                        <span class="rec-title">Rate Limiting</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="1">
                    <div class="rec-header">
                        <span class="rec-title">Context Window Protection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="2">
                    <div class="rec-header">
                        <span class="rec-title">Red Team Testing</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;ConfigAnalyzer&#x27; object has no attribute &#x27;file_exists&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="3">
                    <div class="rec-header">
                        <span class="rec-title">Prompt Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement statistical analysis on prompt patterns</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="4">
                    <div class="rec-header">
                        <span class="rec-title">Prompt Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use ML-based anomaly detection for unusual inputs</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="5">
                    <div class="rec-header">
                        <span class="rec-title">Prompt Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Set up alerts for prompt anomaly detection</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="6">
                    <div class="rec-header">
                        <span class="rec-title">System Prompt Protection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="7">
                    <div class="rec-header">
                        <span class="rec-title">Access Control</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="8">
                    <div class="rec-header">
                        <span class="rec-title">Model Versioning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical " data-priority="critical" data-index="9">
                    <div class="rec-header">
                        <span class="rec-title">Dependency Scanning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="10">
                    <div class="rec-header">
                        <span class="rec-title">API Security</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="11">
                    <div class="rec-header">
                        <span class="rec-title">Differential Privacy</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Opacus or TensorFlow Privacy for differential privacy</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="12">
                    <div class="rec-header">
                        <span class="rec-title">Differential Privacy</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement privacy budgets for model queries</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="13">
                    <div class="rec-header">
                        <span class="rec-title">Differential Privacy</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor epsilon values for privacy guarantees</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="14">
                    <div class="rec-header">
                        <span class="rec-title">Model Watermarking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement watermarking for model outputs</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="15">
                    <div class="rec-header">
                        <span class="rec-title">Model Watermarking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use cryptographic watermarks for model weights</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="16">
                    <div class="rec-header">
                        <span class="rec-title">Model Watermarking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Track watermark verification for model theft detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="17">
                    <div class="rec-header">
                        <span class="rec-title">Secure Model Loading</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use safetensors instead of pickle for model weights</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="18">
                    <div class="rec-header">
                        <span class="rec-title">Secure Model Loading</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Set weights_only=True when using torch.load</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="19">
                    <div class="rec-header">
                        <span class="rec-title">Secure Model Loading</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Validate model files before loading</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="20">
                    <div class="rec-header">
                        <span class="rec-title">PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Presidio or similar for PII detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="21">
                    <div class="rec-header">
                        <span class="rec-title">PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement NER-based PII detection with spaCy</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="22">
                    <div class="rec-header">
                        <span class="rec-title">PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Add custom regex patterns for domain-specific PII</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="23">
                    <div class="rec-header">
                        <span class="rec-title">Data Redaction</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement data masking for sensitive fields</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="24">
                    <div class="rec-header">
                        <span class="rec-title">Data Redaction</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use tokenization for reversible anonymization</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="25">
                    <div class="rec-header">
                        <span class="rec-title">Data Redaction</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Apply redaction before logging or storage</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="26">
                    <div class="rec-header">
                        <span class="rec-title">Consent Management</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="27">
                    <div class="rec-header">
                        <span class="rec-title">NER PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Presidio or SpaCy for NER-based PII detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="28">
                    <div class="rec-header">
                        <span class="rec-title">NER PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement custom NER models for domain-specific PII</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="29">
                    <div class="rec-header">
                        <span class="rec-title">NER PII Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Run PII detection on all inputs and outputs</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="30">
                    <div class="rec-header">
                        <span class="rec-title">Data Retention Policy</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="31">
                    <div class="rec-header">
                        <span class="rec-title">GDPR Compliance</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="32">
                    <div class="rec-header">
                        <span class="rec-title">LLM03: Training Data Poisoning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement data validation pipelines</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="33">
                    <div class="rec-header">
                        <span class="rec-title">LLM03: Training Data Poisoning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Verify data source integrity</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="34">
                    <div class="rec-header">
                        <span class="rec-title">LLM03: Training Data Poisoning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor for anomalies in training data</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="35">
                    <div class="rec-header">
                        <span class="rec-title">LLM04: Model Denial of Service</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="36">
                    <div class="rec-header">
                        <span class="rec-title">LLM06: Sensitive Information Disclosure</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement PII detection and filtering</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="37">
                    <div class="rec-header">
                        <span class="rec-title">LLM06: Sensitive Information Disclosure</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Never include secrets in prompts</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="38">
                    <div class="rec-header">
                        <span class="rec-title">LLM06: Sensitive Information Disclosure</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Add output filtering for sensitive patterns</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="39">
                    <div class="rec-header">
                        <span class="rec-title">LLM08: Excessive Agency</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement human-in-the-loop for critical actions</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="40">
                    <div class="rec-header">
                        <span class="rec-title">LLM08: Excessive Agency</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use principle of least privilege for LLM access</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="41">
                    <div class="rec-header">
                        <span class="rec-title">LLM08: Excessive Agency</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Add approval workflows for sensitive operations</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="42">
                    <div class="rec-header">
                        <span class="rec-title">LLM10: Model Theft</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement rate limiting on API endpoints</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="43">
                    <div class="rec-header">
                        <span class="rec-title">LLM10: Model Theft</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Add query logging and anomaly detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="44">
                    <div class="rec-header">
                        <span class="rec-title">LLM10: Model Theft</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor for extraction patterns</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="45">
                    <div class="rec-header">
                        <span class="rec-title">Drift Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement drift detection with evidently or alibi-detect</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="46">
                    <div class="rec-header">
                        <span class="rec-title">Drift Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor input data distribution changes</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="47">
                    <div class="rec-header">
                        <span class="rec-title">Drift Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Set up automated alerts for drift events</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="48">
                    <div class="rec-header">
                        <span class="rec-title">Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement anomaly detection on model inputs</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="49">
                    <div class="rec-header">
                        <span class="rec-title">Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor for unusual query patterns</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="50">
                    <div class="rec-header">
                        <span class="rec-title">Anomaly Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use statistical methods or ML-based detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="51">
                    <div class="rec-header">
                        <span class="rec-title">Adversarial Attack Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement adversarial input detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="52">
                    <div class="rec-header">
                        <span class="rec-title">Adversarial Attack Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use adversarial robustness toolkits</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="53">
                    <div class="rec-header">
                        <span class="rec-title">Adversarial Attack Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Add input perturbation analysis</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="54">
                    <div class="rec-header">
                        <span class="rec-title">AI Incident Response</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="55">
                    <div class="rec-header">
                        <span class="rec-title">Model Drift Monitoring</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Evidently or alibi-detect for drift monitoring</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="56">
                    <div class="rec-header">
                        <span class="rec-title">Model Drift Monitoring</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Set up automated alerts for significant drift</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="57">
                    <div class="rec-header">
                        <span class="rec-title">Model Drift Monitoring</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement automatic retraining pipelines</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="58">
                    <div class="rec-header">
                        <span class="rec-title">Model Explainability</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use SHAP or LIME for model explanations</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="59">
                    <div class="rec-header">
                        <span class="rec-title">Model Explainability</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Provide decision explanations in outputs</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="60">
                    <div class="rec-header">
                        <span class="rec-title">Model Explainability</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement feature attribution tracking</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="61">
                    <div class="rec-header">
                        <span class="rec-title">Bias Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Fairlearn or AIF360 for bias detection</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="62">
                    <div class="rec-header">
                        <span class="rec-title">Bias Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement fairness metrics tracking</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="63">
                    <div class="rec-header">
                        <span class="rec-title">Bias Detection</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Test for demographic parity and equalized odds</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="64">
                    <div class="rec-header">
                        <span class="rec-title">Model Documentation</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="65">
                    <div class="rec-header">
                        <span class="rec-title">Compliance Tracking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="66">
                    <div class="rec-header">
                        <span class="rec-title">Human Oversight</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="67">
                    <div class="rec-header">
                        <span class="rec-title">Dependency Scanning</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="68">
                    <div class="rec-header">
                        <span class="rec-title">Model Provenance Tracking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use MLflow, DVC, or Weights &amp; Biases for model tracking</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="69">
                    <div class="rec-header">
                        <span class="rec-title">Model Provenance Tracking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement model versioning with metadata</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="70">
                    <div class="rec-header">
                        <span class="rec-title">Model Provenance Tracking</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Maintain model registry with provenance information</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="71">
                    <div class="rec-header">
                        <span class="rec-title">Confidence Scoring</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="72">
                    <div class="rec-header">
                        <span class="rec-title">Temperature Control</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="73">
                    <div class="rec-header">
                        <span class="rec-title">Fairness Metrics</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use Fairlearn or AIF360 for fairness metrics</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="74">
                    <div class="rec-header">
                        <span class="rec-title">Fairness Metrics</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement demographic parity testing</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="75">
                    <div class="rec-header">
                        <span class="rec-title">Fairness Metrics</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Monitor fairness metrics in production</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="76">
                    <div class="rec-header">
                        <span class="rec-title">Bias Testing</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Implement adversarial testing for bias</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="77">
                    <div class="rec-header">
                        <span class="rec-title">Bias Testing</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Test across demographic groups</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="78">
                    <div class="rec-header">
                        <span class="rec-title">Bias Testing</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Use TextAttack or CheckList for NLP bias testing</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="79">
                    <div class="rec-header">
                        <span class="rec-title">Model Cards</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;ConfigAnalyzer&#x27; object has no attribute &#x27;file_exists&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="80">
                    <div class="rec-header">
                        <span class="rec-title">Monitoring Integration</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="81">
                    <div class="rec-header">
                        <span class="rec-title">Audit Logging</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="82">
                    <div class="rec-header">
                        <span class="rec-title">Rollback Capability</span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #667eea; color: white;">Audit</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Detection failed: &#x27;bool&#x27; object has no attribute &#x27;lower&#x27;</p>
                </div>
                
                <div class="rec-item rec-critical rec-hidden" data-priority="critical" data-index="83">
                    <div class="rec-header">
                        <span class="rec-title">LLM output flows to command_injection sink<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:792</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-critical">critical</span>
                        </div>
                    </div>
                    <p class="rec-description">Mitigations for Command Injection:
1. Never pass LLM output to shell commands
2. Use subprocess with shell=False and list arguments
3. Apply allowlist validation for expected values
4. Use shlex.quote() if shell execution is unavoidable</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="84">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_poll&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:739</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="85">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:795</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="86">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:824</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="87">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:853</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="88">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1655</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="89">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1684</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-high rec-hidden" data-priority="high" data-index="90">
                    <div class="rec-header">
                        <span class="rec-title">Insecure tool function &#x27;create_and_run_stream&#x27; executes dangerous operations<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/src/openai/resources/beta/threads/threads.py:1713</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-high">high</span>
                        </div>
                    </div>
                    <p class="rec-description">Secure Tool/Plugin Implementation:
1. NEVER execute shell commands from LLM output directly
2. Use allowlists for permitted commands/operations
3. Validate all file paths against allowed directories
4. Use parameterized queries - never raw SQL from LLM
5. Validate URLs against allowlist before HTTP requests
6. Implement strict input schemas (JSON Schema, Pydantic)
7. Add rate limiting and request throttling
8. Log all tool invocations for audit
9. Use principle of least privilege
10. Implement human-in-the-loop for destructive operations</p>
                </div>
                
                <div class="rec-item rec-low rec-hidden" data-priority="low" data-index="91">
                    <div class="rec-header">
                        <span class="rec-title">Critical decision without oversight in &#x27;sync_main&#x27;<span style="color: #64748b; font-size: 0.8em; margin-left: 8px;">/private/tmp/openai-python-test/examples/azure_ad.py:17</span></span>
                        <div style="display: flex; gap: 6px;">
                            <span class="rec-priority" style="background: #f97316; color: white;">Scan</span>
                            <span class="rec-priority priority-low">low</span>
                        </div>
                    </div>
                    <p class="rec-description">Critical security decision requires human oversight:

1. Implement human-in-the-loop review:
   - Add review queue for high-stakes decisions
   - Require explicit human approval before execution
   - Log all decisions for audit trail

2. Add verification mechanisms:
   - Cross-reference with trusted sources
   - Implement multi-step verification
   - Use confidence thresholds

3. Include safety checks:
   - Set limits on transaction amounts
   - Require secondary confirmation
   - Implement rollback mechanisms

4. Add disclaimers:
   - Inform users output may be incorrect
   - Recommend professional consultation
   - Document limitations clearly

5. Monitor and review:
   - Track decision outcomes
   - Review failures and near-misses
   - Continuously improve safeguards</p>
                </div>
                
                </div>

                <!-- Load More Button -->
                <div id="load-more-container" style="text-align: center; margin-top: 16px;">
                    <button id="load-more-btn" class="load-more-btn" onclick="loadMoreRecommendations()">
                        Show More <span id="remaining-count"></span>
                    </button>
                </div>
            </div>
            
            </div>
            
        <footer>
            <p>Generated by <strong>aisentry CLI</strong> | <a href="https://aisentry.co" target="_blank">aisentry.co</a></p>
        </footer>
    </div>
    <script>
        
        // Filter state
        const filterState = {
            severities: new Set(['CRITICAL', 'HIGH', 'MEDIUM', 'LOW', 'INFO']),
            categories: new Set(),
            searchText: ''
        };

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', initializeFilters);

        function initializeFilters() {
            const findings = document.querySelectorAll('.finding, .vulnerability');
            if (findings.length === 0) return;

            // Collect unique categories
            const categories = new Set();
            findings.forEach(f => {
                if (f.dataset.category) {
                    categories.add(f.dataset.category);
                    filterState.categories.add(f.dataset.category);
                }
            });

            // Build severity chips
            const severityContainer = document.getElementById('severity-chips');
            if (severityContainer) {
                ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW', 'INFO'].forEach(sev => {
                    const count = document.querySelectorAll('[data-severity="' + sev + '"]').length;
                    if (count > 0) {
                        const chip = document.createElement('span');
                        chip.className = 'filter-chip severity-chip active';
                        chip.dataset.type = 'severity';
                        chip.dataset.value = sev;
                        chip.innerHTML = sev + ' <span class="chip-count">(' + count + ')</span>';
                        chip.onclick = function() { toggleChip(this); };
                        severityContainer.appendChild(chip);
                    }
                });
            }

            // Build category chips
            const categoryContainer = document.getElementById('category-chips');
            if (categoryContainer && categories.size > 0) {
                // Sort categories
                const sortedCats = Array.from(categories).sort();
                sortedCats.forEach(cat => {
                    const count = document.querySelectorAll('[data-category="' + cat + '"]').length;
                    const chip = document.createElement('span');
                    chip.className = 'filter-chip category-chip active';
                    chip.dataset.type = 'category';
                    chip.dataset.value = cat;
                    // Shorten category name for display
                    const shortName = cat.length > 20 ? cat.substring(0, 20) + '...' : cat;
                    chip.innerHTML = shortName + ' <span class="chip-count">(' + count + ')</span>';
                    chip.title = cat;
                    chip.onclick = function() { toggleChip(this); };
                    categoryContainer.appendChild(chip);
                });
            }

            // Search input handler
            const searchInput = document.getElementById('filter-search');
            if (searchInput) {
                searchInput.oninput = function() {
                    filterState.searchText = this.value.toLowerCase();
                    applyFilters();
                };
            }

            updateStats();
        }

        function toggleChip(chip) {
            const type = chip.dataset.type;
            const value = chip.dataset.value;

            if (chip.classList.contains('active')) {
                chip.classList.remove('active');
                if (type === 'severity') {
                    filterState.severities.delete(value);
                } else {
                    filterState.categories.delete(value);
                }
            } else {
                chip.classList.add('active');
                if (type === 'severity') {
                    filterState.severities.add(value);
                } else {
                    filterState.categories.add(value);
                }
            }
            applyFilters();
        }

        function applyFilters() {
            const findings = document.querySelectorAll('.finding, .vulnerability');
            let visible = 0;

            findings.forEach(f => {
                const sev = f.dataset.severity;
                const cat = f.dataset.category;
                const text = f.textContent.toLowerCase();

                const sevMatch = filterState.severities.has(sev);
                const catMatch = filterState.categories.size === 0 || filterState.categories.has(cat);
                const searchMatch = !filterState.searchText || text.includes(filterState.searchText);

                if (sevMatch && catMatch && searchMatch) {
                    f.classList.remove('filtered-out');
                    visible++;
                } else {
                    f.classList.add('filtered-out');
                }
            });

            updateStats();

            // Show/hide no results
            const noResults = document.getElementById('no-results');
            if (noResults) {
                noResults.style.display = visible === 0 ? 'block' : 'none';
            }
        }

        function updateStats() {
            const total = document.querySelectorAll('.finding, .vulnerability').length;
            const visible = document.querySelectorAll('.finding:not(.filtered-out), .vulnerability:not(.filtered-out)').length;
            const statsEl = document.getElementById('filter-stats');
            if (statsEl) {
                statsEl.innerHTML = 'Showing <strong>' + visible + '</strong> of <strong>' + total + '</strong>';
            }
        }

        function selectAllSeverity() {
            document.querySelectorAll('.filter-chip.severity-chip').forEach(chip => {
                chip.classList.add('active');
                filterState.severities.add(chip.dataset.value);
            });
            applyFilters();
        }

        function selectNoneSeverity() {
            document.querySelectorAll('.filter-chip.severity-chip').forEach(chip => {
                chip.classList.remove('active');
                filterState.severities.delete(chip.dataset.value);
            });
            applyFilters();
        }

        function selectAllCategory() {
            document.querySelectorAll('.filter-chip.category-chip').forEach(chip => {
                chip.classList.add('active');
                filterState.categories.add(chip.dataset.value);
            });
            applyFilters();
        }

        function selectNoneCategory() {
            document.querySelectorAll('.filter-chip.category-chip').forEach(chip => {
                chip.classList.remove('active');
                filterState.categories.delete(chip.dataset.value);
            });
            applyFilters();
        }

        function resetFilters() {
            // Reset all severity chips
            document.querySelectorAll('.filter-chip.severity-chip').forEach(chip => {
                chip.classList.add('active');
                filterState.severities.add(chip.dataset.value);
            });

            // Reset all category chips
            document.querySelectorAll('.filter-chip.category-chip').forEach(chip => {
                chip.classList.add('active');
                filterState.categories.add(chip.dataset.value);
            });

            // Reset search
            const searchInput = document.getElementById('filter-search');
            if (searchInput) {
                searchInput.value = '';
                filterState.searchText = '';
            }

            applyFilters();
        }

        // Tab navigation
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabId) {
                    btn.classList.add('active');
                }
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });

            // Re-initialize filters for the active tab if needed
            setTimeout(initializeFilters, 100);
        }

        // Dark mode toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        // Initialize theme from localStorage
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }

        // Initialize tabs on load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            initTheme();

            // Set up tab click handlers
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.onclick = function() {
                    switchTab(this.dataset.tab);
                };
            });

            // Initialize recommendation pagination
            initRecommendations();
            // Initialize findings pagination
            initFindings();
        });

        // Recommendation pagination state
        let recState = {
            visibleCount: 10,
            pageSize: 10,
            currentFilter: 'all',
            totalItems: 0
        };

        function initRecommendations() {
            const items = document.querySelectorAll('#recommendations-list .rec-item');
            recState.totalItems = items.length;
            updateLoadMoreButton();
        }

        function updateLoadMoreButton() {
            const btn = document.getElementById('load-more-btn');
            const container = document.getElementById('load-more-container');
            const countSpan = document.getElementById('remaining-count');

            if (!btn || !container) return;

            // Count visible items based on current filter
            const items = document.querySelectorAll('#recommendations-list .rec-item');
            let matchingItems = 0;
            let visibleItems = 0;

            items.forEach(item => {
                const priority = item.dataset.priority;
                const matchesFilter = recState.currentFilter === 'all' || priority === recState.currentFilter;

                if (matchesFilter) {
                    matchingItems++;
                    if (!item.classList.contains('rec-hidden')) {
                        visibleItems++;
                    }
                }
            });

            const remaining = matchingItems - visibleItems;

            if (remaining <= 0) {
                container.style.display = 'none';
            } else {
                container.style.display = 'block';
                countSpan.textContent = `(${remaining} more)`;
            }
        }

        function loadMoreRecommendations() {
            const items = document.querySelectorAll('#recommendations-list .rec-item');
            let shown = 0;
            let toShow = recState.pageSize;

            items.forEach(item => {
                const priority = item.dataset.priority;
                const matchesFilter = recState.currentFilter === 'all' || priority === recState.currentFilter;

                if (matchesFilter && item.classList.contains('rec-hidden') && toShow > 0) {
                    item.classList.remove('rec-hidden');
                    toShow--;
                }
            });

            updateLoadMoreButton();
        }

        function filterBySeverity(severity) {
            recState.currentFilter = severity;

            // Update button states
            document.querySelectorAll('.severity-filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.severity === severity) {
                    btn.classList.add('active');
                }
            });

            // Filter items
            const items = document.querySelectorAll('#recommendations-list .rec-item');
            let visibleCount = 0;

            items.forEach((item, index) => {
                const priority = item.dataset.priority;
                const matchesFilter = severity === 'all' || priority === severity;

                // Remove all visibility classes first
                item.classList.remove('rec-hidden', 'rec-filtered');

                if (!matchesFilter) {
                    item.classList.add('rec-filtered');
                } else {
                    // Show first 10 matching items
                    if (visibleCount >= recState.pageSize) {
                        item.classList.add('rec-hidden');
                    }
                    visibleCount++;
                }
            });

            updateLoadMoreButton();
        }

        // Findings pagination state
        let findingsState = {
            visibleCount: 10,
            pageSize: 10,
            currentFilter: 'all',
            totalItems: 0
        };

        function initFindings() {
            const items = document.querySelectorAll('#findings-list .finding');
            findingsState.totalItems = items.length;
            updateFindingsLoadMoreButton();
        }

        function updateFindingsLoadMoreButton() {
            const btn = document.getElementById('findings-load-more-btn');
            const container = document.getElementById('findings-load-more-container');
            const countSpan = document.getElementById('findings-remaining-count');

            if (!btn || !container) return;

            const items = document.querySelectorAll('#findings-list .finding');
            let matchingItems = 0;
            let visibleItems = 0;

            items.forEach(item => {
                const severity = item.dataset.severity;
                const matchesFilter = findingsState.currentFilter === 'all' || severity === findingsState.currentFilter;

                if (matchesFilter) {
                    matchingItems++;
                    if (!item.classList.contains('finding-hidden')) {
                        visibleItems++;
                    }
                }
            });

            const remaining = matchingItems - visibleItems;

            if (remaining <= 0) {
                container.style.display = 'none';
            } else {
                container.style.display = 'block';
                countSpan.textContent = `(${remaining} more)`;
            }
        }

        function loadMoreFindings() {
            const items = document.querySelectorAll('#findings-list .finding');
            let toShow = findingsState.pageSize;

            items.forEach(item => {
                const severity = item.dataset.severity;
                const matchesFilter = findingsState.currentFilter === 'all' || severity === findingsState.currentFilter;

                if (matchesFilter && item.classList.contains('finding-hidden') && toShow > 0) {
                    item.classList.remove('finding-hidden');
                    toShow--;
                }
            });

            updateFindingsLoadMoreButton();
        }

        function filterFindingsBySeverity(severity) {
            findingsState.currentFilter = severity;

            // Update button states (only for findings buttons)
            document.querySelectorAll('.severity-filter-btn[data-target="findings"]').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.severity === severity) {
                    btn.classList.add('active');
                }
            });

            // Filter items
            const items = document.querySelectorAll('#findings-list .finding');
            let visibleCount = 0;

            items.forEach((item, index) => {
                const itemSeverity = item.dataset.severity;
                const matchesFilter = severity === 'all' || itemSeverity === severity;

                // Remove all visibility classes first
                item.classList.remove('finding-hidden', 'finding-filtered');

                if (!matchesFilter) {
                    item.classList.add('finding-filtered');
                } else {
                    // Show first 10 matching items
                    if (visibleCount >= findingsState.pageSize) {
                        item.classList.add('finding-hidden');
                    }
                    visibleCount++;
                }
            });

            updateFindingsLoadMoreButton();
        }

        // Category accordion functionality
        function toggleCategory(header) {
            const card = header.parentElement;
            card.classList.toggle('open');
        }

        function toggleAllCategories() {
            const cards = document.querySelectorAll('.category-card');
            const btn = document.getElementById('toggle-categories');
            const allOpen = [...cards].every(card => card.classList.contains('open'));

            cards.forEach(card => {
                if (allOpen) {
                    card.classList.remove('open');
                } else {
                    card.classList.add('open');
                }
            });

            if (btn) {
                btn.textContent = allOpen ? 'Expand All' : 'Collapse All';
            }
        }
        
    </script>
</body>
</html>